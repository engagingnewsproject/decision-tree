"use strict";function Tree(e){function t(t){if(!/https?:\/\/(?:dev\/decision-tree|tree\.engagingnewsproject\.org|enptree\.staging\.wpengine\.com)\/api\//.test(t.responseURL))return console.error("responseURL from an invalidated source."),!1;var i=JSON.parse(t.response);r=i,o="start",n=i.starts[0].start_id;var s=window.TreeTemplates.tree,a=s(i);e.container.innerHTML=a}var r,o,n;return"string"!=typeof e.slug?(console.error("Tree slug is must be a string."),!1):"object"!==_typeof(e.container)?(console.error("Tree container must be a valid object. Try `container: document.getElementById(your-id)`."),!1):(this.getData=function(){return r},this.getState=function(){return o},this.getStateID=function(){return n},this.setState=function(e){o=e},this.setStateID=function(e){n=e},void getTreeData(e.slug,"http://dev/decision-tree/api/v1/trees/"+e.slug+"/compiled?minfied=true").then(t).catch(handleTreeDataError))}function getTreeData(e,t){return new Promise(function(e,r){var o=new XMLHttpRequest;o.overrideMimeType("application/json"),o.open("GET",t,!0),o.onload=function(){200===o.status?e(o):r(Error("Tree could not be loaded:"+o.statusText))},o.onerror=function(){r(Error("There was a network error."))},o.send()})}function handleTreeDataError(e){console.error(e)}Handlebars.registerHelper("environment",function(e){return"has-js"}),Handlebars.registerHelper("group_start",function(e,t,r,o){for(var n=0;n<r.length;n++)if(r[n].group_id===t)return r[n].questions[0]===e?o.fn(r[n].title):"";return""}),Handlebars.registerHelper("group_end",function(e,t,r,o){for(var n=0;n<r.length;n++)if(r[n].group_id===t){var i=r[n].questions;return i[i.length-1]===e?o.fn(this):""}return""}),Handlebars.registerHelper("group_title",function(e,t,r){for(var o=0;o<t.length;o++)if(t[o].group_id===e)return t[o].title;return""});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Tree.prototype.getDataByType=function(e,t){var r=void 0,o=void 0,n=void 0;return o=["question","group","end","start"],o.includes(e)?(n=this.getData(),n=n[e+"s"],void 0!==t&&(r=this.getIndexBy(n,e+"_id",t),n=void 0!==r?n[r]:void 0),n):(console.error("Allowed getDataByType types are "+o.toString()),!1)},Tree.prototype.getQuestions=function(e){return void 0!==e?this.getDataByType("question",e):this.getDataByType("question")},Tree.prototype.getStarts=function(e){return void 0!==e?this.getDataByType("start",e):this.getDataByType("start")},Tree.prototype.getEnds=function(e){return void 0!==e?this.getDataByType("end",e):this.getDataByType("end")},Tree.prototype.getGroups=function(e){return void 0!==e?this.getDataByType("group",e):this.getDataByType("group")},Tree.prototype.getOptions=function(e,t){var r=void 0,o=void 0,n=void 0;return n=this.getQuestions(e),void 0!==t?(o=this.getIndexBy(n.options,"option_id",t),r=n.options[o]):r=n.options,r},Tree.prototype.getIndexBy=function(e,t,r){for(var o=0;o<e.length;o++)if(e[o][t]==r)return o};