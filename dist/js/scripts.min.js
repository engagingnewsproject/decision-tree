"use strict";function Tree(e){function t(t){if(!/https?:\/\/(?:dev\/decision-tree|tree\.engagingnewsproject\.org|enptree\.staging\.wpengine\.com)\/api\//.test(t.responseURL))throw new Error("resopnseURL from an invalidated source.");var i=JSON.parse(t.response);r=i,n="start",o=i.starts[0].start_id;var s=window.TreeTemplates.tree,a=s(i);e.container.innerHTML=a}var r,n,o;if("string"!=typeof e.slug)throw new Error("Tree slug is required must be a string.");if("object"!==_typeof(e.container))throw new Error("Tree container must be an object. Try `container: document.getElementById(your-id)`.");this.getData=function(){return r},this.getState=function(){return n},this.getStateID=function(){return o},this.setState=function(e){n=e},this.setStateID=function(e){o=e},getTreeData(e.slug,"http://dev/decision-tree/api/v1/trees/"+e.slug+"/compiled?minfied=true").then(t).catch(handleTreeDataError)}function getTreeData(e,t){return new Promise(function(e,r){var n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",t,!0),n.onload=function(){200===n.status?e(n):r(Error("Tree could not be loaded:"+n.statusText))},n.onerror=function(){r(Error("There was a network error."))},n.send()})}function handleTreeDataError(e){throw console.log(e),new Error("Tree data could not be loaded.")}Handlebars.registerHelper("environment",function(e){return"has-js"}),Handlebars.registerHelper("group_start",function(e,t,r,n){for(var o=0;o<r.length;o++)if(r[o].group_id===t)return r[o].questions[0]===e?n.fn(r[o].title):"";return""}),Handlebars.registerHelper("group_end",function(e,t,r,n){for(var o=0;o<r.length;o++)if(r[o].group_id===t){var i=r[o].questions;return i[i.length-1]===e?n.fn(this):""}return""}),Handlebars.registerHelper("group_title",function(e,t,r){for(var n=0;n<t.length;n++)if(t[n].group_id===e)return t[n].title;return""});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Tree.prototype.getQuestion=function(e){return questionIndex=this.getIndexBy(this.getData(),"question_id",e),question=this.data.questions[questionIndex],question},Tree.prototype.getDataByType=function(e,t){var r=void 0,n=void 0,o=void 0;if(n=["question","group","end","start"],!n.includes(e))throw new Error("Allowed getDataByType types are "+n.toString());return o=this.getData(),o=o[e+"s"],void 0!==t&&(r=this.getIndexBy(o,e+"_id",t),o=o[r]),o},Tree.prototype.getQuestions=function(e){return void 0!==e?this.getDataByType("question",e):this.getDataByType("question")},Tree.prototype.getStarts=function(e){return void 0!==e?this.getDataByType("start",e):this.getDataByType("start")},Tree.prototype.getEnds=function(e){return void 0!==e?this.getDataByType("end",e):this.getDataByType("end")},Tree.prototype.getGroups=function(e){return void 0!==e?this.getDataByType("group",e):this.getDataByType("group")},Tree.prototype.getOptions=function(e,t){var r=void 0,n=void 0,o=void 0;return o=this.getQuestions(e),void 0!==t?(n=this.getIndexBy(o.options,"option_id",t),r=o.options[n]):r=o.options,r},Tree.prototype.getIndexBy=function(e,t,r){for(var n=0;n<e.length;n++)if(e[n][t]==r)return n;return-1};var Trees=[];